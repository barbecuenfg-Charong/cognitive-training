# 发布归档（v1.0）

## 一、系统概览
- **项目名称**：Project Port Manager (项目端口管理器)
- **核心功能**：统一管理本地开发项目的启动、停止与端口监控
- **技术栈**：Python (FastAPI) + HTML/JS (原生) + PowerShell
- **当前版本**：1.0.0 (2026-02-20)

## 二、目录结构
- `app.py`：后端核心逻辑（FastAPI服务、进程管理、配置读写）
- `config.json`：项目配置文件（存储各项目路径、命令、端口）
- `static/`：前端静态资源
- `start_port_manager.bat` / `.ps1`：一键启动脚本
- `register_project.py`：项目注册工具脚本

## 三、核心功能说明（2026-02-20 更新）

### 1. 进程管理与端口释放
- **启动**：通过 `subprocess.Popen` 启动服务进程。
- **停止（增强版）**：
  - 支持 Windows `taskkill /F /T` 强制结束进程树，防止子进程残留。
  - **孤儿进程清理**：若管理平台重启丢失 PID，停止服务时会自动检测端口占用（`netstat`），并根据端口反查 PID 进行强制结束。
  - **安全保护**：脚本层增加了对系统进程（PID 0, 4）的保护，防止误杀。

### 2. 启动脚本优化
- **双击启动**：`start_port_manager.bat` 支持直接双击运行。
- **端口预清理**：启动前自动检测并清理自身端口（5555），防止“端口被占用”错误。
- **后台运行**：服务窗口自动最小化，减少对用户的干扰。

### 3. 项目配置 (config.json)
- 支持多项目管理（Word Learning, Stock Analysis 等）。
- 支持自定义启动命令（如 `npm run dev` 或 `node ...`）。
- 支持端口监控与状态实时反馈。

## 四、部署与使用
1. **启动平台**：
   - 双击 `start_port_manager.bat`。
   - 浏览器自动打开 `http://127.0.0.1:5555`。
2. **管理项目**：
   - 在 Dashboard 或 Projects 页面点击“启动全部”或“停止全部”。
   - 点击服务后的“启动/停止/重启”按钮进行单独控制。
3. **添加新项目**：
   - 修改 `config.json` 或使用 `register_project.py` 脚本。

## 五、故障排查
- **服务无法停止**：
  - 点击“停止”按钮。若状态仍为“运行中”，请刷新页面。
  - 若端口仍被占用，系统会尝试通过端口反查强制结束进程。
- **启动报错**：
  - 检查 `config.json` 中的 `cwd`（工作目录）是否正确。
  - 检查 `command` 是否能在命令行中独立运行。
